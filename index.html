<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>CodePen - Animated Login Form using Html & CSS Only</title>
  <link rel="stylesheet" href="./style.css">

</head>

<body>
  <script>
    function display(sectionId) {
      // Hide both sections first
      document.getElementById('signInSection').style.display = 'none';
      document.getElementById('signUpSection').style.display = 'none';

      // Show the selected section
      document.getElementById(sectionId).style.display = 'block';
    }
  </script>
  <section>

    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>

    <div id="signInSection" class="signin">
      <div class="content">
        <h2>Sign In</h2>
        <form id="loginForm">
          <div class="form">
            <div class="inputBox">
              <input class="email" id="loginEmail" type="email" name="email" required>
              <i>Email</i>
            </div>
            <div class="inputBox">
              <input class="name" id="loginPassword" type="password" name="password" required>
              <i>Password</i>
            </div>
            <div class="links">
              <a href="#">Forgot Password</a>
              <a href="#" onclick="display('signUpSection'); return false;">Sign Up</a>
            </div>
            <div class="inputBox">
              <input type="submit" value="Login">
            </div>
          </div>
        </form>
      </div>
    </div>

    <div id="signUpSection" class="signin" style="display:none;">
      <div class="content">
        <h2>Sign Up</h2>
        <form id="registerForm">
          <div class="form">
            <div class="inputBox">
              <input class="email" id="registerEmail" type="email" name="email" required>
              <i>Email</i>
            </div>
            <div class="inputBox">
              <input class="name" id="registerPassword" type="password" name="password" required>
              <i>Password</i>
            </div>
            <div class="links">
              <a href="#" onclick="display('signInSection'); return false;">Already have an account? Sign In</a>
            </div>
            <div class="inputBox">
              <input type="submit" value="Register">
            </div>
          </div>
        </form>
      </div>
    </div>


  </section>
  
        <div id="toast-container"></div>
  
  <script>

// --- UTILITY FUNCTIONS ---

        // Function to switch between Sign In and Sign Up forms
        function display(sectionId) {
            document.getElementById('signInSection').style.display = 'none';
            document.getElementById('signUpSection').style.display = 'none';
            document.getElementById(sectionId).style.display = 'block';
        }

        // Main function to create and show a toast notification
        function showToast(message, type = 'info', duration = 5000) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast toast--${type}`;
            const icons = { success: '✔', error: '✖', info: 'ℹ' };
            const icon = icons[type];
            toast.innerHTML = `<div class="toast-icon">${icon}</div><div class="toast-message">${message}</div>`;
            container.appendChild(toast);

            if (type === 'success') createConfetti(toast);

            setTimeout(() => {
                toast.classList.add('hiding');
                toast.addEventListener('animationend', () => toast.remove());
            }, duration);
        }

        // Helper function to create the confetti effect for success toasts
        function createConfetti(toast) {
            const confettiCount = 50;
            for (let i = 0; i < confettiCount; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                const randomAngle = Math.random() * 360;
                const randomDistance = Math.random() * 100 + 50;
                confetti.style.setProperty('--randomAngle', randomAngle + 'deg');
                confetti.style.setProperty('--randomDistance', randomDistance + 'px');
                toast.appendChild(confetti);
                confetti.animate([
                    { transform: 'translate(0, 0) rotate(0deg)', opacity: 1 },
                    { transform: `translate(${Math.cos(randomAngle) * randomDistance}px, ${Math.sin(randomAngle) * randomDistance}px) rotate(720deg)`, opacity: 0 }
                ], { duration: 800 + Math.random() * 500, easing: 'cubic-bezier(0.1, 0.9, 0.2, 1)', fill: 'forwards' });
            }
        }



// --- Handle the Login Form Submission ---
const loginForm = document.getElementById('loginForm');

loginForm.addEventListener('submit', async (event) => {
    // 1. Prevent the default form submission
    event.preventDefault();

    // 2. Get the data from the login form inputs
    const email = loginForm.querySelector('input[type="email"]').value;
    const password = loginForm.querySelector('input[type="password"]').value;

    // 3. Send the data to your backend '/login' endpoint
    try {
        const response = await fetch('http://localhost:3000/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email, password }),
        });

        // 4. Handle the response from the server
        const resultMessage = await response.text();

        if (response.ok) {
            // ✅ SUCCESS: Show the success toast with confetti!
            showToast('Login Successful! Welcome back. 🎉', 'success');
            loginForm.reset();

            // Pro Tip: If you redirect the user, add a small delay
            // so they have time to see the beautiful toast message.
            setTimeout(() => {
                // window.location.href = '/dashboard'; // Uncomment this to redirect
            }, 1500); // 1.5-second delay

        } else {
            // ❌ FAILED: Show an error toast
            showToast(resultMessage, 'error');
        }

    } catch (error) {
        console.error('Error during login:', error);
        showToast('Login failed due to a network error.', 'error');
    }
});






    // This function switches between the sign-in and sign-up forms
    function display(sectionId) {
      document.getElementById('signInSection').style.display = 'none';
      document.getElementById('signUpSection').style.display = 'none';
      document.getElementById(sectionId).style.display = 'block';
    }

    // Wait for the HTML document to be fully loaded before running the script
    document.addEventListener('DOMContentLoaded', () => {

      // --- Handle the Registration Form Submission ---
      const registerForm = document.getElementById('registerForm');

      registerForm.addEventListener('submit', async (event) => {
        // 1. Prevent the default form submission (which reloads the page)
        event.preventDefault();

        // 2. Get the data from the form inputs
        const email = registerForm.querySelector('input[type="email"]').value;
        const password = registerForm.querySelector('input[type="password"]').value;

        // 3. Send the data to your backend '/submit-form' endpoint
        try {
          const response = await fetch('http://localhost:3000/submit-form', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email, password }),
          });

          // 4. Handle the response from the server
          const resultMessage = await response.text();
          alert(resultMessage); // Show the server's message (e.g., "User added successfully!")

          if (response.ok) {
            registerForm.reset(); // Clear the form on success
            display('signInSection'); // Switch to the login form
          }

        } catch (error) {
          console.error('Error during registration:', error);
          alert('Registration failed. Please try again.');
        }
      });


      // --- Handle the Login Form Submission ---
      const loginForm = document.getElementById('loginForm');

      loginForm.addEventListener('submit', async (event) => {
        // 1. Prevent the default form submission
        event.preventDefault();

        // 2. Get the data from the login form inputs
        // ✅ FIXED: Changed selector from 'input[type="text"]' to 'input[type="email"]'
        const email = loginForm.querySelector('input[type="email"]').value;
        const password = loginForm.querySelector('input[type="password"]').value;

        // 3. Send the data to your backend '/login' endpoint
        try {
          const response = await fetch('http://localhost:3000/login', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email, password }),
          });

          // 4. Handle the response from the server
          const resultMessage = await response.text();
          alert(resultMessage); // Show "Login successful!" or "Invalid password or email"

          if (response.ok) {
            loginForm.reset(); // Clear the form on successful login
            // You would typically redirect the user to another page here, for example:
            // window.location.href = '/dashboard'; 
          }

        } catch (error) {
          console.error('Error during login:', error);
          alert('Login failed. Please try again.');
        }
      });
    });
  </script>
</body>

</html>